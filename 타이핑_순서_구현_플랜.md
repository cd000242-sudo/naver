# 네이버 블로그 자동화 타이핑 순서 재구현 플랜

## 현재 문제점

1. **제목 입력 후 불필요한 제목 클릭**: 제목 입력 후 본문으로 이동해야 하는데 제목을 다시 클릭하는 로직이 있음
2. **포커스 관리 복잡**: 여러 곳에서 포커스 확인 및 재설정 로직이 중복되어 있음
3. **타이핑 순서 불명확**: 각 단계에서 어떤 요소를 클릭하고 타이핑해야 하는지 명확하지 않음

## 목표 타이핑 순서

```
1. 제목 입력
   └─ 제목 입력 후 본문 영역으로 자동 이동 (제목 클릭 없음)

2. 각 소제목별 반복:
   ├─ 소제목 타이핑 (28px)
   ├─ Enter 2회
   ├─ .se-section-text 클릭 (본문 영역)
   ├─ 이미지 삽입 (있는 경우)
   ├─ Enter 2회
   ├─ 본문 타이핑 (19px, 줄 단위, 0.03초 간격)
   ├─ Enter 2회
   └─ 구분선 추가 (마지막 소제목이 아닌 경우)
       └─ Enter 2회

3. 마지막 처리:
   ├─ Enter 5회
   ├─ 해시태그 5개 입력
   └─ 발행
```

## 새로운 구현 구조

### 1. 제목 입력 함수 개선

```typescript
private async inputTitle(title: string): Promise<void> {
  // 1. 제목 요소 찾기
  // 2. 제목 타이핑
  // 3. Enter 키로 본문 영역으로 자동 이동 (제목 클릭 없음)
  // 4. 본문 영역 포커스 확인
}
```

**핵심 변경사항:**
- 제목 입력 후 `Enter` 키로 본문 영역으로 자동 이동
- 제목 요소를 다시 클릭하지 않음
- 본문 영역 포커스 확인만 수행

### 2. 본문 영역 포커스 관리 단순화

```typescript
private async ensureBodyFocus(): Promise<boolean> {
  // 1. 현재 포커스가 본문 영역인지 확인
  // 2. 본문 영역이 아니면 .se-section-text 클릭
  // 3. 포커스 확인 반환
}
```

**핵심 변경사항:**
- 단일 함수로 포커스 관리 통합
- 제목 영역 확인 로직 제거 (제목 입력 후에는 본문 영역에만 있음)
- 불필요한 재시도 로직 제거

### 3. 소제목 입력 함수 개선

```typescript
private async typeHeading(text: string, fontSize: number): Promise<void> {
  // 1. 현재 포커스가 본문 영역인지 확인
  // 2. 폰트 크기 설정 (28px)
  // 3. 소제목 타이핑
  // 4. Enter 2회
  // 5. 본문 영역 포커스 확인
}
```

**핵심 변경사항:**
- 소제목 입력 전 본문 영역 포커스 확인
- 소제목 입력 후 Enter 2회로 새 단락 생성
- 불필요한 클릭 로직 제거

### 4. 본문 입력 함수 개선

```typescript
private async typeBodyContent(text: string, fontSize: number): Promise<void> {
  // 1. .se-section-text 클릭 (본문 영역)
  // 2. 폰트 크기 설정 (19px)
  // 3. 줄 단위 타이핑 (각 줄마다 0.03초 간격)
  // 4. 각 줄 끝에 Enter 입력
}
```

**핵심 변경사항:**
- .se-section-text 직접 클릭
- 줄 단위 타이핑 (이미 구현됨)
- 정렬 버튼 클릭 제거 (이미 구현됨)

### 5. 메인 타이핑 순서 함수 재구현

```typescript
private async applyStructuredContent(resolved: ResolvedRunOptions): Promise<void> {
  // 0. 도움말 닫기
  // 1. 제목 입력 (자동으로 본문 영역으로 이동)
  // 2. 각 소제목별 반복:
  //    - 소제목 입력
  //    - Enter 2회
  //    - 본문 영역 포커스 확인
  //    - 이미지 삽입 (있는 경우)
  //    - Enter 2회
  //    - 본문 입력
  //    - Enter 2회
  //    - 구분선 (마지막이 아닌 경우)
  //    - Enter 2회
  // 3. Enter 5회
  // 4. 해시태그 입력
  // 5. 발행
}
```

## 필요한 셀렉터 정보

사용자에게 다음 정보를 요청:

1. **제목 입력 필드 셀렉터**
   - 현재: `.se-section-documentTitle`
   - 확인 필요: 실제 HTML 구조

2. **본문 영역 셀렉터**
   - 현재: `.se-section-text`
   - 확인 필요: 실제 HTML 구조

3. **소제목 입력 후 본문 영역 셀렉터**
   - 소제목 입력 후 Enter 2회 후 나타나는 본문 영역
   - 확인 필요: 실제 HTML 구조

4. **이미지 삽입 후 본문 영역 셀렉터**
   - 이미지 삽입 후 Enter 2회 후 나타나는 본문 영역
   - 확인 필요: 실제 HTML 구조

## 구현 단계

### Phase 1: 제목 입력 개선
- [ ] `inputTitle` 함수 수정
- [ ] 제목 입력 후 Enter로 본문 영역 이동
- [ ] 제목 클릭 로직 제거

### Phase 2: 포커스 관리 단순화
- [ ] `ensureBodyFocus` 함수 생성
- [ ] 모든 포커스 확인 로직을 이 함수로 통합
- [ ] 제목 영역 확인 로직 제거

### Phase 3: 소제목 입력 개선
- [ ] `typeHeading` 함수 수정
- [ ] 불필요한 클릭 로직 제거
- [ ] Enter 2회 후 포커스 확인

### Phase 4: 본문 입력 개선
- [ ] `typeBodyContent` 함수 확인 (이미 개선됨)
- [ ] .se-section-text 클릭 로직 확인

### Phase 5: 메인 함수 재구현
- [ ] `applyStructuredContent` 함수 재작성
- [ ] 단순하고 명확한 순서로 변경
- [ ] 불필요한 재시도 로직 제거

## 테스트 시나리오

1. **제목 입력 테스트**
   - 제목 입력 후 제목을 다시 클릭하지 않는지 확인
   - 본문 영역으로 자동 이동하는지 확인

2. **소제목 입력 테스트**
   - 소제목 입력 후 올바른 위치에 본문이 입력되는지 확인
   - 불필요한 클릭이 없는지 확인

3. **이미지 삽입 테스트**
   - 이미지 삽입 후 올바른 위치에 본문이 입력되는지 확인
   - 네이버 이미지 라이브러리가 열리지 않는지 확인

4. **전체 흐름 테스트**
   - 모든 소제목과 본문이 올바른 순서로 입력되는지 확인
   - 구분선이 올바른 위치에 추가되는지 확인
   - 해시태그가 올바르게 입력되는지 확인

## 예상 개선 효과

1. **코드 가독성 향상**: 단순하고 명확한 타이핑 순서
2. **안정성 향상**: 불필요한 클릭 제거로 오류 감소
3. **성능 향상**: 재시도 로직 제거로 실행 시간 단축
4. **유지보수성 향상**: 단일 책임 함수로 변경 관리 용이









